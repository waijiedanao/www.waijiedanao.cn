webpackJsonp([9],{"9MH8":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("lC5x"),i=n.n(a),r=n("J0Oq"),c=n.n(r),s=n("rVsN"),o=n.n(s),p={data:function(){return{payDiloagShow:!1,wechatQrcodeImg:"",payTime:"",openid:""}},mixins:[{data:function(){return{priceList:[],privilegeList:["可关注500个公众号","查看任意公众号1年内阅读量、在看数据","公众号数据更新","更多会员特权功能逐渐开放中..."]}},mixins:[n("f744").a],created:function(){this.init()},methods:{init:function(){this.getPriceList()},getPriceList:function(){var t=this;return c()(i.a.mark(function e(){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get(t.serverPath.memberPriceLiss,{});case 2:n=e.sent,t.priceList=n.data;case 4:case"end":return e.stop()}},e,t)}))()},buyMemberRequest:function(t,e){var n,a=this;return new o.a((n=c()(i.a.mark(function n(r,c){var s;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a.$http.post(a.serverPath.buyMemberWechatPay,t,e);case 2:s=n.sent,r(s);case 4:case"end":return n.stop()}},n,a)})),function(t,e){return n.apply(this,arguments)}))}}}],created:function(){this.openid=sessionStorage.getItem("openid")||""},methods:{buyMember:function(t){var e=this;return c()(i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:clearInterval(e.payTimer),e.$base.showLoading(),e.openid?e.wachatClientPay(t):e.wechatCodePay(t);case 3:case"end":return n.stop()}},n,e)}))()},wachatClientPay:function(t){var e=this;return c()(i.a.mark(function n(){var a,r,c;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.$http.post(e.serverPath.wachatClientPay,{pay_type:t.pay_type,openid:e.openid});case 2:a=n.sent,r=JSON.parse(a.data.jsapiStr),e.$base.hideLoading(),c=e,WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:r.appId,timeStamp:r.timeStamp,nonceStr:r.nonceStr,package:r.package,signType:"MD5",paySign:r.paySign},function(t){"get_brand_wcpay_request:ok"==t.err_msg&&c.$base.toast("支付成功")});case 7:case"end":return n.stop()}},n,e)}))()},wechatCodePay:function(t){var e=this;return c()(i.a.mark(function n(){var a;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.buyMemberRequest({pay_type:t.pay_type},function(){e.$base.hideLoading()});case 2:a=n.sent,e.payDiloagShow=!0,e.wechatQrcodeImg=a.data.qrcode,e.$base.hideLoading(),e.payTimer=setInterval(function(){e.payCheck(a.data.out_trade_no)},2e3);case 7:case"end":return n.stop()}},n,e)}))()},payCheck:function(t){var e=this;return c()(i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.$http.post(e.serverPath.payCheck,{out_trade_no:t});case 2:n.sent.data.success&&(clearInterval(e.payTimer),e.payDiloagShow=!1,e.$base.toast("支付成功","success"));case 4:case"end":return n.stop()}},n,e)}))()}},beforeRouteLeave:function(t,e,n){clearInterval(this.payTimer),n()},components:{XDialog:n("fRcE").a}},l={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("x-header",{attrs:{"left-options":{backText:""}}},[t._v("购买会员")]),t._v(" "),n("div",{staticClass:"main-content"},[n("ul",{staticClass:"price-list"},t._l(t.priceList,function(e,a){return n("li",{key:a,attrs:{span:10}},[n("div",{staticClass:"price-item"},[n("div",{staticClass:"flex justify-between align-center"},[n("div",{staticClass:"price"},[n("span",{staticClass:"text-big"},[t._v("¥"+t._s(e.total_fee/100))]),t._v(" "),n("span",[t._v("/"+t._s(e.time_str))])]),t._v(" "),n("button",{staticClass:"btn btn-main buy-btn",on:{click:function(n){return t.buyMember(e)}}},[t._v("购买")])]),t._v(" "),n("div",{staticClass:"hint-text"},[t._v(t._s(e.per_day_str))])])])}),0),t._v(" "),n("div",{staticClass:"privilege"},[n("div",{staticClass:"part-title"},[t._v("会员特权")]),t._v(" "),n("ul",{staticClass:"privilege-list"},t._l(t.privilegeList,function(e,a){return n("li",{key:a},[t._v(t._s(a+1)+"、"+t._s(e))])}),0)])]),t._v(" "),n("x-dialog",{staticClass:"pay-dialog",attrs:{"hide-on-blur":""},model:{value:t.payDiloagShow,callback:function(e){t.payDiloagShow=e},expression:"payDiloagShow"}},[n("div",{staticClass:"dialog-title"},[t._v("微信支付")]),t._v(" "),n("img",{staticClass:"qrcode-img",attrs:{src:t.wechatQrcodeImg,alt:""}}),t._v(" "),n("div",{on:{click:function(e){t.payDiloagShow=!1}}},[n("span",{staticClass:"vux-close"})])])],1)},staticRenderFns:[]};var d=n("C7Lr")(p,l,!1,function(t){n("JlbG")},"data-v-29c0774c",null);e.default=d.exports},H3cV:function(t,e,n){(t.exports=n("UTlt")(!1)).push([t.i,"\n.main-content[data-v-29c0774c] {\n  background: #fff;\n  min-height: 100vh;\n  margin-top: calc(46px + 0.4rem) !important;\n}\n.main-content .price-list .price-item[data-v-29c0774c] {\n  padding: 0.6rem 0.4rem;\n  margin-bottom: 0.4rem;\n  -webkit-box-shadow: 1px 0px 10px 0 rgba(0, 0, 0, 0.12);\n          box-shadow: 1px 0px 10px 0 rgba(0, 0, 0, 0.12);\n}\n.main-content .price-list .price-item .text-big[data-v-29c0774c] {\n  font-size: 0.6rem;\n}\n.main-content .price-list .price-item .price[data-v-29c0774c] {\n  letter-spacing: 0.01rem;\n  margin-bottom: 0.2rem;\n}\n.main-content .price-list .price-item .price span[data-v-29c0774c] {\n  display: inline-block;\n  vertical-align: baseline;\n}\n.main-content .price-list .price-item .buy-btn[data-v-29c0774c] {\n  width: 1.4rem;\n  line-height: 0.7rem;\n}\n.main-content .price-list .price-item .hint-text[data-v-29c0774c] {\n  color: #8590a6;\n}\n.main-content .privilege .part-title[data-v-29c0774c] {\n  line-height: 0.8rem;\n  font-size: 0.3rem;\n  margin: 0.4rem 0 0.3rem;\n  font-weight: bold;\n  padding-left: 0.4rem;\n  border-bottom: 1px solid #efefef;\n}\n.main-content .privilege .privilege-list[data-v-29c0774c] {\n  padding-left: 0.4rem;\n  line-height: 0.6rem;\n}\n.pay-dialog[data-v-29c0774c] {\n  text-align: center;\n}\n.pay-dialog .dialog-title[data-v-29c0774c] {\n  font-weight: bold;\n  font-size: 0.3rem;\n  padding: 0.4rem 0.8rem;\n}\n.pay-dialog .qrcode-img[data-v-29c0774c] {\n  display: block;\n  width: 4rem;\n  height: 4rem;\n  margin: 0 auto 0.4rem;\n}\n.pay-dialog .vux-close[data-v-29c0774c] {\n  padding-bottom: 1rem;\n}\n",""])},JlbG:function(t,e,n){var a=n("H3cV");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("FIqI")("9de7ab34",a,!0,{})}});